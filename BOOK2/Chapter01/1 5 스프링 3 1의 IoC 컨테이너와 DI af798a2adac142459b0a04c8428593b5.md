# 1.5 스프링 3.1의 IoC 컨테이너와 DI

<스프링 3.1 에 새롭게 도입된 IoC/Di 기술 2가지>

1. 강화된 자바 코드 빈 설정 

    -  자바 코드를 이용한 설정 방식을 빈 설정 메타정보 작성에 본격적으로 사용할 수 있도록 기능을 대폭 확장한 것

2. 런타임 환경 추상화
- 개발과 테스트, 운영 단계에서 IoC/DI 구성이 달라질 때 이를 효과적으로 관리할 수 있게 해주는 런타임 환경정보 관리 기능

- 스프링 3.1 의 가장 큰 특징 
= 자바 코드를 이용한 설정 메타정보 작성이 쉽다는 점
= 그래서 XML 을 사용하지 않거나 최소화한 채로 스프링 애플리케이션 개발이 가능

## 1.5.1  빈의 역할과 구분

<빈의 종류>

1) 애플리케이션 로직 빈

- 스프링 빈 = 스프링 IoC/DI 컨테이너에 의해 생성되고 관리되는 오브젝트
- 일반적으로 애플리케이션의 로직을 담고 있는 주요 클래스의 오브젝트가 빈으로 지정
- 데이터 로직을 다루는 DAO / 서비스 오브젝트 / 컨트롤러 오브젝트

2) 애플리케이션 인프라 빈

- 빈으로 컨테이너에 등록되는 오브젝트
- 애플리케이션의 로직을 직접 담당하지 않고 애플리케이션 로직 빈을 지원
- 애플리케이션이 동작하는데 직접 참여, 빈의 일종
- 애플리케이션 기반 빈 또는 애플리케이션 인프라스트럭처 빈이라 부르겠음

3) 컨테이너 인프라 빈

- 스프링 컨테이너의 기능을 확장해서 빈의 등록과 생성, 관계 설정, 초기화 등의 작업에 참여하는 빈

<컨테이너 인프라 빈과 전용 태그>

- 한번에 여러개의 빈을 동시에 설정해야 하는 경우가 있기에 스프링은 이런 빈을 개발자가 XML에 직접 등록하는 대신 전용 태그를 사용해 간접적으로 등록하는 방법을 권장

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled.png)

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%201.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%201.png)

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%202.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%202.png)

- 몇개의 빈이 만들어질지 생각해보기
- 여기서 제 생각은 다음과 같은 빈 클래스의 이름을 빈설정해주면 Hello 빈을 생성할 수 있다 생각함

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%203.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%203.png)

- ConfigurationClassPostProcessor 는 @Configuration 과 @Bean을 이용해 새로운 빈을 등록하는 역할
- AutowiredAnnotationBeanPostProcessor는 @Autowired가 붙은 필드를 찾아서 빈 의존관계를 설정
- CommonAnnotationBeanPostProcessor 는 @PostConstrunct 가 붙은 메소드를 빈이 초기화된 뒤에 호출해주는 기능 제공

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%204.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%204.png)

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%205.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%205.png)

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%206.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%206.png)

<빈의 역할>

- 스프링 빈의 역할

![1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%207.png](1%205%20%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%203%201%E1%84%8B%E1%85%B4%20IoC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%20af798a2adac142459b0a04c8428593b5/Untitled%207.png)

- ROLE_APPLICATION 은 애플리케이션 로직 빈과 애플리케이션 인프라 빈처럼 애플리케이션이 동작하는 중에 사용되는 빈
- ROLE_SUPPORT 는 복합 구조의 빈을 정의할 때 보조적으로 사용되는 빈의 역할
- ROLE_INFRASTRUCTURE 은 컨테이너 인프라 빈
- 스프링에서 사용되는 빈을 역할과 성격에 따라 구분하면 빈 메타정보의 역할 속성을 기준으로 애플리케이션 빈과 인프라 빈(컨테이너 인프라 빈) 으로 나뉘고 다시 애플리케이션빈을 구분하면 애플리케이션 로직 빈과 애플리케이션 인프라 빈으로 나뉨